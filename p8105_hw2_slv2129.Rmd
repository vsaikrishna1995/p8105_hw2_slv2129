---
title: "Homework 2"
author: "Krishna Vemulapalli"
date: "28/09/2020"
output: github_document
---

```{r setup}
library(tidyverse)
library(readxl)
library(haven)
library(janitor)
```

## Problem 1

Reading and cleaning the Mr.Trashwheel dataset:

```{r}
trashwheel_df = 
  read_xlsx(
    "C:/Users/Krishna/Desktop/Sem 3/Data Science/Assignment 2/p8105_hw2_slv2129/data/Trash-Wheel-Collection-Totals-8-6-19.xlsx", 
            range = cell_cols("A:N")) %>%
  clean_names() %>%
  drop_na(dumpster) %>%
  mutate (
    sports_balls = round(sports_balls),
    sports_balls = as.integer(sports_balls)
  )
```

Reading, cleaning and manipulating the 2017 and 2018 precipitation data sheets:

```{r}
#2017 Precipitation#

precip2017_df = 
  read_xlsx("C:/Users/Krishna/Desktop/Sem 3/Data Science/Assignment 2/p8105_hw2_slv2129/data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
            sheet = "2017 Precipitation",
            skip = 1) %>%
  rename(Total_Precipitation_inches = Total) %>%
  clean_names() %>%
  drop_na(month) %>%
  mutate (year = 2017,
          month = month.name[month]) %>%
  subset (select = c(3,1,2)) 

#2018 Precipitation#

precip2018_df = 
  read_xlsx("C:/Users/Krishna/Desktop/Sem 3/Data Science/Assignment 2/p8105_hw2_slv2129/data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
            sheet = "2018 Precipitation",
            skip = 1) %>%
  rename(Total_Precipitation_inches = Total) %>%
  clean_names() %>%
  drop_na(month) %>%
  mutate (year = 2018,
          month = month.name[month]) %>%
  subset (select = c(3,1,2))

#Combining 2017 and 2018 datasets#
precipitation_df = 
  rbind(precip2017_df, precip2018_df) %>%
  mutate (month = as.character(month))
```

Describing the Mr.Trashwheel dataset:



## Problem 2

Reading, cleaning and manipulating the NYC transit dataset

```{r}
nyctran_df = 
  read.csv("C:/Users/Krishna/Desktop/Sem 3/Data Science/Assignment 2/p8105_hw2_slv2129/data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>%
  subset(select = c(2:16, 18, 20, 17, 23)) %>%
  clean_names() %>%
  mutate(entry = recode(entry, YES = T, NO = F))
```

Describing the NYC transit dataset:

This dataset provides data on New York city transit data associated with subway station system. Specifically, this dataset stores information related to entrance and exit for every NYC station. This dataset contains the following variables: `r names(nyctran_df)`. As part of the data cleaning process, the variable names have been transformed to match the appropriate naming convention using the janitor library function and the data type of entry variable has been convereted from character to logical. Although the original dataset consisted of many variables, only a specific set of variables that are mentioned above were retained in the dataset after the cleaning process. This dataset has the following dimension (row, columns): `r dim(nyctran_df)`. After assessing the dataframe, it can inferred that the data can't be considered tidy because of the dataframe structure associated with the route number and name columns. 

Answering the questions given: 

```{r}
nycdist_df = nyctran_df %>% distinct(line, station_name, .keep_all = T)
dist_stations = nrow(nycdist_df)

ada_comp = nycdist_df %>% filter(ada == T) %>% nrow()

prop_novend_enter = ((nyctran_df %>% filter(vending == "NO" & entry == T) %>% nrow()) / 
                       (nyctran_df %>% filter(vending == "NO") %>% nrow())) %>% round(3)

dist_routes_df = nyctran_df %>% distinct(route1, route2, route3, route4, route5, route6, route7, route8, route9, route10, route11, .keep_all = T)

dist_stations_A_df = dist_routes_df %>% filter(route1 == "A" | route2 == "A" | route3 == "A" | route4 == "A" | route5 == "A" | route6 == "A" | route7 == "A" | route8 == "A"| route9 == "A" | route10 == "A" | route11 == "A")

ada_comp_A = dist_stations_A_df %>% filter(ada == T) %>% nrow()
```

How many distinct stations are there?\
There are `r dist_stations` distinct stations in NYC subway system. 

How many stations are ADA compliant?\
There are `r ada_comp` stations that are ADA compliant. 

What proportion of station entrances / exits without vending allow entrance?\
`r prop_novend_enter` proportion of station entrances / exits without vending allow entrance. 

How many distinct stations serve the A train? Of the stations that serve the A train, how many are ADA compliant?\
There are `r dist_stations_A_df %>% nrow()` distinct stations that serve the A train. Among these stations, `r ada_comp_A` are ADA compliant. 
